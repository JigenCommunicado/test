# üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Express Bot —Å ngrok

## üìã –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ ngrok:
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω—ã–π** - –Ω–∞–º–Ω–æ–≥–æ –Ω–∞–¥–µ–∂–Ω–µ–µ Cloudflare
- ‚úÖ **–ë—ã—Å—Ç—Ä—ã–π** - –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫
- ‚úÖ **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ http://localhost:4040
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –ª–µ–≥–∫–æ –∑–∞–ø—É—Å–∫–∞—Ç—å/–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok:
```bash
cd /root/test/express_bot

# –°–∫–∞—á–∏–≤–∞–µ–º ngrok
wget -O /tmp/ngrok.zip https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-v3-stable-linux-amd64.zip

# –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º
unzip /tmp/ngrok.zip -d /usr/local/bin/

# –î–µ–ª–∞–µ–º –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x /usr/local/bin/ngrok
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ ngrok —Ç—É–Ω–Ω–µ–ª—å:
```bash
# –í –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
ngrok http 5010
```

### 3. –ü–æ–ª—É—á–∏—Ç–µ URL —Ç—É–Ω–Ω–µ–ª—è:
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ:
```
Session Status                online
Account                       (Plan: Free)
Version                       3.x.x
Region                        United States (us)
Latency                       -
Web Interface                 http://127.0.0.1:4040
Forwarding                    https://abc123.ngrok.io -> http://localhost:5010
```

**–í–∞—à URL**: `https://abc123.ngrok.io`

### 4. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
```bash
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ config.json
nano /root/test/express_bot/config.json

# –ó–∞–º–µ–Ω–∏—Ç–µ webhook_url –Ω–∞:
"webhook_url": "https://abc123.ngrok.io/webhook"
```

### 5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤ Express.ms:
1. –í–æ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å Express.ms
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "SmartApps"
3. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ**: Flight Booking Bot
   - **URL –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**: `https://abc123.ngrok.io`
   - **Webhook URL**: `https://abc123.ngrok.io/webhook`
   - **–ò–∫–æ–Ω–∫–∞**: ‚úàÔ∏è

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
# Health check
curl https://abc123.ngrok.io/health

# Manifest
curl https://abc123.ngrok.io/manifest

# Webhook test
curl -X POST https://abc123.ngrok.io/webhook \
  -H "Content-Type: application/json" \
  -d '{"type": "message", "user_id": "test", "text": "/start"}'
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- **–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å**: `https://abc123.ngrok.io/admin`
- **ngrok –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: http://localhost:4040
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: `https://abc123.ngrok.io/api/stats`

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç—É–Ω–Ω–µ–ª—å
pkill ngrok

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç—É–Ω–Ω–µ–ª—å
ngrok http 5010

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
curl http://localhost:4040/api/tunnels
```

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç –¥–æ–ª–∂–µ–Ω:
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å "–æ–Ω–ª–∞–π–Ω" –≤ Express.ms
- –û—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∫–æ–º–∞–Ω–¥—É `/start`
- –ü–æ–∑–≤–æ–ª—è—Ç—å –ø–æ–¥–∞–≤–∞—Ç—å –∑–∞—è–≤–∫–∏ –Ω–∞ —Ä–µ–π—Å—ã
- –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º:
1. **–ë–æ—Ç –æ—Ñ—Ñ–ª–∞–π–Ω**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook URL –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
2. **–û—à–∏–±–∫–∏ webhook**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞
3. **–ù–µ –æ—Ç–≤–µ—á–∞–µ—Ç**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Ç—É–Ω–Ω–µ–ª—è
4. **–¢—É–Ω–Ω–µ–ª—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ ngrok

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞:
- –õ–æ–≥–∏ –±–æ—Ç–∞: `tail -f /root/test/express_bot/fixed_bot.log`
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: `/root/test/express_bot/config.json`
- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å: `https://abc123.ngrok.io/admin`
- ngrok –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: http://localhost:4040


