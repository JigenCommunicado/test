# üöÄ Express SmartApp - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Express –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–º

## üìã –û–±–∑–æ—Ä

–≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Express SmartApp —Å–æ–≥–ª–∞—Å–Ω–æ [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Express](https://docs.express.ms/smartapps/). SmartApp –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–º Express –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º—É –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–æ–∫ –Ω–∞ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–æ—á–Ω—ã–µ —Ä–µ–π—Å—ã.

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

### **–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- **–ù–∞–∑–≤–∞–Ω–∏–µ:** Flight Booking SmartApp
- **–í–µ—Ä—Å–∏—è:** 1.0.0
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–æ–∫ –Ω–∞ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–æ—á–Ω—ã–µ —Ä–µ–π—Å—ã
- **–ò–∫–æ–Ω–∫–∞:** ‚úàÔ∏è
- **–¶–≤–µ—Ç:** #0088cc
- **–ü–æ—Ä—Ç:** 5005

### **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ API —Å–æ–≥–ª–∞—Å–Ω–æ Express:**
- **–ú–∞–Ω–∏—Ñ–µ—Å—Ç:** `/manifest` - –æ–ø–∏—Å–∞–Ω–∏–µ SmartApp
- **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** `/interface` - –≥–ª–∞–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–§–æ—Ä–º–∞:** `/form` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
- **–û—Ç–ø—Ä–∞–≤–∫–∞:** `/submit` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–∫–∏
- **Webhook:** `/webhook` - —Å–æ–±—ã—Ç–∏—è –æ—Ç Express
- **–ó–¥–æ—Ä–æ–≤—å–µ:** `/health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

## üöÄ –ó–∞–ø—É—Å–∫

### **–ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫:**
```bash
cd /root/test/express_bot
./start_express_smartapp_proper.sh
```

### **–û—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
./stop_express_smartapp_proper.sh
```

## üì± API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### **1. –ú–∞–Ω–∏—Ñ–µ—Å—Ç SmartApp:**
```http
GET /manifest
```
**–û—Ç–≤–µ—Ç:**
```json
{
  "name": "Flight Booking SmartApp",
  "version": "1.0.0",
  "description": "–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–æ–∫ –Ω–∞ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–æ—á–Ω—ã–µ —Ä–µ–π—Å—ã",
  "icon": "‚úàÔ∏è",
  "color": "#0088cc",
  "permissions": ["read_user_info", "send_messages", "access_files"],
  "capabilities": ["flight_booking", "application_management", "notifications"],
  "endpoints": {
    "main": "/",
    "api": "/",
    "webhook": "/webhook"
  }
}
```

### **2. –ì–ª–∞–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
```http
GET /interface
```

### **3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ñ–æ—Ä–º—ã:**
```http
GET /form
```

### **4. –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–∫–∏:**
```http
POST /submit
Content-Type: application/json

{
  "form_data": {
    "location": "–ú–æ—Å–∫–≤–∞",
    "oke": "–û–ö–≠ 1",
    "date": "2025-09-20",
    "position": "–ë–ü",
    "fio": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
    "tab_num": "123456",
    "direction": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
    "wishes": "–û—Å–æ–±—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è"
  },
  "user_context": {
    "user_id": "express_user_123",
    "user_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "platform": "express_smartapp"
  }
}
```

### **5. Webhook –¥–ª—è Express:**
```http
POST /webhook
Content-Type: application/json

{
  "type": "user_joined",
  "user_id": "user123",
  "data": {...}
}
```

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Express –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–º

### **1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ Express —Å–µ—Ä–≤–µ—Ä–µ:**

–°–æ–≥–ª–∞—Å–Ω–æ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Express SmartApp](https://docs.express.ms/smartapps/):

1. **–î–æ–±–∞–≤–∏—Ç—å SmartApp –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Express:**
   - **URL:** `http://your-server:5005/`
   - **–ú–∞–Ω–∏—Ñ–µ—Å—Ç:** `http://your-server:5005/manifest`
   - **–ù–∞–∑–≤–∞–Ω–∏–µ:** "Flight Booking SmartApp"
   - **–ò–∫–æ–Ω–∫–∞:** ‚úàÔ∏è
   - **–¶–≤–µ—Ç:** #0088cc

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook:**
   - **URL:** `http://your-server:5005/webhook`
   - **–ú–µ—Ç–æ–¥—ã:** POST
   - **–°–æ–±—ã—Ç–∏—è:** user_joined, user_left, message_received

### **2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Express —Å–µ—Ä–≤–µ—Ä–∞:**

```yaml
smartapps:
  - name: "Flight Booking SmartApp"
    url: "http://localhost:5005/"
    manifest_url: "http://localhost:5005/manifest"
    webhook_url: "http://localhost:5005/webhook"
    icon: "‚úàÔ∏è"
    color: "#0088cc"
    permissions:
      - "read_user_info"
      - "send_messages"
      - "access_files"
      - "manage_applications"
```

### **3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–Ω–æ Express:**

SmartApp –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Express:

- **–ú–∞–Ω–∏—Ñ–µ—Å—Ç** - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π UI
- **–§–æ—Ä–º—ã** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–ª–µ–π
- **Webhook** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ Express

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
curl http://localhost:5005/health

# –ú–∞–Ω–∏—Ñ–µ—Å—Ç
curl http://localhost:5005/manifest

# –ì–ª–∞–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
curl http://localhost:5005/interface

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
curl http://localhost:5005/form
```

### **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏:**
```bash
curl -X POST http://localhost:5005/submit \
  -H "Content-Type: application/json" \
  -d '{
    "form_data": {
      "location": "–ú–æ—Å–∫–≤–∞",
      "oke": "–û–ö–≠ 1",
      "date": "2025-09-20",
      "position": "–ë–ü",
      "fio": "–¢–µ—Å—Ç –¢–µ—Å—Ç–æ–≤–∏—á",
      "tab_num": "123456",
      "direction": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
      "wishes": "–¢–µ—Å—Ç–æ–≤–∞—è –∑–∞—è–≤–∫–∞"
    },
    "user_context": {
      "user_id": "express_test_user",
      "user_name": "–¢–µ—Å—Ç –¢–µ—Å—Ç–æ–≤–∏—á",
      "platform": "express_smartapp"
    }
  }'
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **–õ–æ–≥–∏:**
```bash
tail -f logs/express_smartapp_proper.log
```

### **–°—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:**
```bash
ps aux | grep express_smartapp_proper
```

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤:**
```bash
netstat -tlnp | grep 5005
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. **HTTPS** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
2. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Express
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è** - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ–ª–Ω—ã–π –ª–æ–≥ –æ–ø–µ—Ä–∞—Ü–∏–π
5. **Webhook security** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

## üéØ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

**Express SmartApp –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Express –∏ –≥–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏!**

### **‚úÖ –ß—Ç–æ –≥–æ—Ç–æ–≤–æ:**
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ API** —Å–æ–≥–ª–∞—Å–Ω–æ Express
- ‚úÖ **–ú–∞–Ω–∏—Ñ–µ—Å—Ç SmartApp** –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ **Webhook –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** –¥–ª—è —Å–æ–±—ã—Ç–∏–π
- ‚úÖ **–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** Express
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- ‚úÖ **–ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–æ–∫

### **üåê –î–æ—Å—Ç—É–ø–Ω—ã–µ URL:**
- **SmartApp:** http://localhost:5005/
- **–ú–∞–Ω–∏—Ñ–µ—Å—Ç:** http://localhost:5005/manifest
- **API:** http://localhost:5005/
- **Webhook:** http://localhost:5005/webhook
- **Health:** http://localhost:5005/health

**SmartApp –≥–æ—Ç–æ–≤ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –≤ Express –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ!** üöÄ‚úàÔ∏è







