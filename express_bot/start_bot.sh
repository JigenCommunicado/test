#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ Final Express Bot
echo "üöÄ –ó–∞–ø—É—Å–∫ Express Flight Booking Bot..."

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /root/test/express_bot

# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source venv/bin/activate

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
echo "üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏..."
python3 express_bot_config.py

if [ $? -ne 0 ]; then
    echo "‚ùå –û—à–∏–±–∫–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏."
    exit 1
fi

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
echo "üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤..."
pkill -f express_bot.py 2>/dev/null
pkill -f express_bot_webhook_server.py 2>/dev/null
pkill -f express_bot_enhanced.py 2>/dev/null
pkill -f express_bot_final.py 2>/dev/null

# –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
sleep 2

# –ó–∞–ø—É—Å–∫–∞–µ–º Express Bot Webhook Server
echo "ü§ñ –ó–∞–ø—É—Å–∫ Express Bot Webhook Server..."
nohup python3 express_bot_webhook.py > bot.log 2>&1 &
BOT_PID=$!

# –ñ–¥–µ–º –∑–∞–ø—É—Å–∫–∞
sleep 3

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
if ps -p $BOT_PID > /dev/null; then
    echo "‚úÖ Express Bot –∑–∞–ø—É—â–µ–Ω —É—Å–ø–µ—à–Ω–æ (PID: $BOT_PID)"
    echo "üìã –õ–æ–≥–∏: tail -f bot.log"
    echo "üîó Webhook URL: https://comparing-doom-solving-royalty.trycloudflare.com/webhook"
    echo ""
    echo "üéØ –§–∏–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (–Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–¥–∞ –∏–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤):"
    echo "‚Ä¢ ‚ú® –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω–ª–∞–π–Ω –∫–Ω–æ–ø–æ–∫"
    echo "‚Ä¢ üìÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π"
    echo "‚Ä¢ üè¢ –í—ã–±–æ—Ä –û–ö–≠ –ø–æ –ª–æ–∫–∞—Ü–∏—è–º"
    echo "‚Ä¢ üåç –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ –ª–æ–∫–∞—Ü–∏—è–º"
    echo "‚Ä¢ üîÑ –ü–æ–ª–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è —Å –∫–Ω–æ–ø–∫–∞–º–∏ '–ù–∞–∑–∞–¥'"
    echo "‚Ä¢ ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π"
    echo "‚Ä¢ üìù –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è"
    echo "‚Ä¢ üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
    echo "‚Ä¢ üé® –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö"
    echo ""
    echo "üì± –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:"
    echo "‚Ä¢ /start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –ø–æ–ª–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º"
    echo ""
    echo "üéÆ –ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–∫–∏:"
    echo "1. –í—ã–±–æ—Ä –ª–æ–∫–∞—Ü–∏–∏ (–ú–æ—Å–∫–≤–∞, –°–ü–±, –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫, –°–æ—á–∏)"
    echo "2. –í—ã–±–æ—Ä –û–ö–≠ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ª–æ–∫–∞—Ü–∏–∏)"
    echo "3. –í—ã–±–æ—Ä –¥–∞—Ç—ã —á–µ—Ä–µ–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—å"
    echo "4. –í—ã–±–æ—Ä –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ (–ë–ü, –ë–ü BS, –°–ë–≠, –ò–ü–ë)"
    echo "5. –í–≤–æ–¥ –§–ò–û –∏ —Ç–∞–±–µ–ª—å–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞"
    echo "6. –í—ã–±–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–∏–∑ —Å–ø–∏—Å–∫–∞ –∏–ª–∏ —Ä—É—á–Ω–æ–π –≤–≤–æ–¥)"
    echo "7. –í–≤–æ–¥ –ø–æ–∂–µ–ª–∞–Ω–∏–π"
    echo "8. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏"
else
    echo "‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ Express Bot"
    echo "üìã –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: cat bot.log"
    exit 1
fi

echo ""
echo "üéØ Express Bot –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!"
echo "üí° –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏: pkill -f express_bot_webhook.py"
