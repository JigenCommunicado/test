<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ - SmartApp</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            flex-wrap: wrap;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }

        .nav-tab {
            flex: 1;
            min-width: 120px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 14px;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s;
        }

        .nav-tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .nav-tab:hover {
            background: #e9ecef;
        }

        .tab-content {
            padding: 30px;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-warning {
            background: #ffc107;
            color: #212529;
        }

        .btn-warning:hover {
            background: #e0a800;
        }

        .users-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .users-table th,
        .users-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .users-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        .users-table tr:hover {
            background: #f8f9fa;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-blocked {
            background: #f8d7da;
            color: #721c24;
        }

        .status-active { 
            background: #e8f5e8; 
            color: #2e7d32; 
            padding: 4px 8px; 
            border-radius: 4px; 
            font-size: 0.9em;
        }
        .status-inactive { 
            background: #ffebee; 
            color: #c62828; 
            padding: 4px 8px; 
            border-radius: 4px; 
            font-size: 0.9em;
        }

        .role-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .role-admin {
            background: #e2e3e5;
            color: #383d41;
        }

        .role-manager {
            background: #d1ecf1;
            color: #0c5460;
        }

        .role-user {
            background: #d4edda;
            color: #155724;
        }

        .role-viewer {
            background: #f8d7da;
            color: #721c24;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-approved {
            background: #d4edda;
            color: #155724;
        }

        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }

        .status-completed {
            background: #d1ecf1;
            color: #0c5460;
        }

        .login-form {
            max-width: 400px;
            margin: 0 auto;
            padding: 40px;
        }

        .login-form h2 {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .user-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .permissions-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .permission-item {
            background: #e9ecef;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }
            
            .users-table {
                font-size: 12px;
            }
            
            .users-table th,
            .users-table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üë• –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h1>
            <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Å–∏—Å—Ç–µ–º–æ–π</p>
        </div>

        <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
        <div id="loginForm" class="login-form">
            <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
            <form id="loginFormElement">
                <div class="form-group">
                    <label for="username">–õ–æ–≥–∏–Ω</label>
                    <input type="text" id="username" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω" required>
                </div>
                <div class="form-group">
                    <label for="password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    –í–æ–π—Ç–∏
                </button>
            </form>
            <div id="loginError" class="error" style="display: none;"></div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
        <div id="mainInterface" style="display: none;">
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showTab('dashboard')">üìä –î–∞—à–±–æ—Ä–¥</button>
                <button class="nav-tab" onclick="showTab('applications')">üìã –ó–∞—è–≤–∫–∏</button>
                <button class="nav-tab" onclick="showTab('users')">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
                <button class="nav-tab" onclick="showTab('statistics')">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                <button class="nav-tab" onclick="showTab('logs')">üìù –õ–æ–≥–∏</button>
                <button class="nav-tab" onclick="showTab('notifications')">üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</button>
                <button class="nav-tab" onclick="showTab('periods')">üìÖ –ü–µ—Ä–∏–æ–¥—ã –∑–∞—è–≤–æ–∫</button>
                <button class="nav-tab" onclick="showTab('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>
                <button class="nav-tab" onclick="showTab('config')">‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</button>
                <button class="nav-tab" onclick="showTab('settings')">üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                <button class="nav-tab" onclick="logout()">üö™ –í—ã—Ö–æ–¥</button>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞ -->
            <div id="dashboardTab" class="tab-content active">
                <h3>üìä –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã</h3>
                <div id="dashboardContent" class="loading">
                    –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞...
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –∑–∞—è–≤–æ–∫ -->
            <div id="applicationsTab" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3>üìã –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞—è–≤–æ–∫</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-success" onclick="exportToExcel()">üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel</button>
                        <button class="btn btn-info" onclick="refreshApplications()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                        <button class="btn btn-primary" onclick="toggleAutoRefresh()" id="autoRefreshBtn">‚è∏Ô∏è –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</button>
                    </div>
                </div>

                <!-- –§–∏–ª—å—Ç—Ä—ã -->
                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div class="form-group">
                            <label for="statusFilter">–°—Ç–∞—Ç—É—Å:</label>
                            <select id="statusFilter" onchange="filterApplications()">
                                <option value="">–í—Å–µ</option>
                                <option value="pending">–û–∂–∏–¥–∞–µ—Ç</option>
                                <option value="approved">–û–¥–æ–±—Ä–µ–Ω–∞</option>
                                <option value="rejected">–û—Ç–∫–ª–æ–Ω–µ–Ω–∞</option>
                                <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–∞</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="dateFilter">–î–∞—Ç–∞:</label>
                            <select id="dateFilter" onchange="filterApplications()">
                                <option value="today">–°–µ–≥–æ–¥–Ω—è</option>
                                <option value="week">–ó–∞ –Ω–µ–¥–µ–ª—é</option>
                                <option value="month">–ó–∞ –º–µ—Å—è—Ü</option>
                                <option value="all">–í—Å–µ –≤—Ä–µ–º—è</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="searchFilter">–ü–æ–∏—Å–∫:</label>
                            <input type="text" id="searchFilter" placeholder="–§–ò–û, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ..." onkeyup="filterApplications()">
                        </div>
                    </div>
                </div>

                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—è–≤–æ–∫ -->
                <div id="applicationsStats" class="loading">
                    –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...
                </div>

                <!-- –¢–∞–±–ª–∏—Ü–∞ –∑–∞—è–≤–æ–∫ -->
                <div id="applicationsTable" class="loading">
                    –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫...
                </div>

                <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
                <div id="applicationsPagination" style="display: none; text-align: center; margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="previousPage()">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∞—è</button>
                    <span id="pageInfo" style="margin: 0 20px;"></span>
                    <button class="btn btn-secondary" onclick="nextPage()">–°–ª–µ–¥—É—é—â–∞—è ‚Üí</button>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
            <div id="usersTab" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                    <button class="btn btn-primary" onclick="showCreateUserForm()">
                        ‚ûï –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    </button>
                </div>

                <div id="usersTable" class="loading">
                    –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
            <div id="statisticsTab" class="tab-content">
                <h3>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã</h3>
                <div id="statisticsContent" class="loading">
                    –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ª–æ–≥–æ–≤ -->
            <div id="logsTab" class="tab-content">
                <h3>üìù –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
                <div style="margin-bottom: 20px;">
                    <select id="logLevel" onchange="loadLogs()">
                        <option value="all">–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
                        <option value="error">–¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏</option>
                        <option value="warning">–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</option>
                        <option value="info">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</option>
                    </select>
                    <input type="number" id="logLines" value="100" min="10" max="1000" onchange="loadLogs()" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫">
                    <button class="btn btn-primary" onclick="loadLogs()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                </div>
                <div id="logsContent" class="loading">
                    –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ–≤...
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
            <div id="notificationsTab" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h3>
                    <button class="btn btn-primary" onclick="showCreateScheduleForm()">
                        ‚ûï –°–æ–∑–¥–∞—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
                    </button>
                </div>

                <div id="schedulesTable" class="loading">
                    –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π...
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ø–µ—Ä–∏–æ–¥–æ–≤ –∑–∞—è–≤–æ–∫ -->
            <div id="periodsTab" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3>üìÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞–º–∏ –∑–∞—è–≤–æ–∫</h3>
                    <button class="btn btn-primary" onclick="window.open('application_periods.html', '_blank')">
                        üóìÔ∏è –û—Ç–∫—Ä—ã—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞–º–∏
                    </button>
                </div>
                <div class="info-card">
                    <h4>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–µ—Ä–∏–æ–¥–∞—Ö</h4>
                    <p>–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–µ—Ä–∏–æ–¥–∞–º–∏ –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–æ–∫ –Ω–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ–π—Å—ã. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –≤—ã—à–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –ø–æ–ª–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.</p>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
            <div id="profileTab" class="tab-content">
                <h3>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h3>
                <div id="userProfile" class="user-info">
                    –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è...
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ -->
            <div id="configTab" class="tab-content">
                <h3>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π</h3>
                
                <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ -->
                <div class="config-nav" style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="showConfigSection('basic')">üîß –û—Å–Ω–æ–≤–Ω—ã–µ</button>
                    <button class="btn btn-primary" onclick="showConfigSection('directions')">üåç –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</button>
                    <button class="btn btn-primary" onclick="showConfigSection('oke')">üè¢ –û–ö–≠</button>
                    <button class="btn btn-primary" onclick="showConfigSection('positions')">üë®‚Äçüíº –î–æ–ª–∂–Ω–æ—Å—Ç–∏</button>
                    <button class="btn btn-primary" onclick="showConfigSection('backup')">üíæ –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏</button>
                </div>

                <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
                <div id="configBasic" class="config-section">
                    <h4>üîß –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞</h4>
                    <div id="basicConfigContent" class="loading">
                        –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫...
                    </div>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏ -->
                <div id="configDirections" class="config-section" style="display: none;">
                    <h4>üåç –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏</h4>
                    <div id="directionsConfigContent" class="loading">
                        –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π...
                    </div>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –û–ö–≠ -->
                <div id="configOke" class="config-section" style="display: none;">
                    <h4>üè¢ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –û–ö–≠</h4>
                    <div id="okeConfigContent" class="loading">
                        –ó–∞–≥—Ä—É–∑–∫–∞ –û–ö–≠...
                    </div>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—è–º–∏ -->
                <div id="configPositions" class="config-section" style="display: none;">
                    <h4>üë®‚Äçüíº –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—è–º–∏</h4>
                    <div id="positionsConfigContent" class="loading">
                        –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π...
                    </div>
                </div>

                <!-- –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ -->
                <div id="configBackup" class="config-section" style="display: none;">
                    <h4>üíæ –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</h4>
                    <div id="backupConfigContent" class="loading">
                        –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π...
                    </div>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
            <div id="settingsTab" class="tab-content">
                <h3>üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
                
                <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
                <div class="settings-nav" style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="showSettingsSection('general')">‚öôÔ∏è –û–±—â–∏–µ</button>
                    <button class="btn btn-primary" onclick="showSettingsSection('security')">üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</button>
                    <button class="btn btn-primary" onclick="showSettingsSection('notifications')">üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</button>
                    <button class="btn btn-primary" onclick="showSettingsSection('logging')">üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
                    <button class="btn btn-primary" onclick="showSettingsSection('maintenance')">üîß –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</button>
                    <button class="btn btn-primary" onclick="showSettingsSection('stresstest')">üß™ –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç</button>
                </div>

                <!-- –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
                <div id="settingsGeneral" class="settings-section">
                    <h4>‚öôÔ∏è –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h4>
                    <div id="generalSettingsContent" class="loading">
                        –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫...
                    </div>
                </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ -->
                <div id="settingsSecurity" class="settings-section" style="display: none;">
                    <h4>üîí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h4>
                    <div id="securitySettingsContent" class="loading">
                        –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏...
                    </div>
                </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
                <div id="settingsNotifications" class="settings-section" style="display: none;">
                    <h4>üîî –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h4>
                    <div id="notificationSettingsContent" class="loading">
                        –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π...
                    </div>
                </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è -->
                <div id="settingsLogging" class="settings-section" style="display: none;">
                    <h4>üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</h4>
                    <div id="loggingSettingsContent" class="loading">
                        –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è...
                    </div>
                </div>

                <!-- –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ -->
                <div id="settingsMaintenance" class="settings-section" style="display: none;">
                    <h4>üîß –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</h4>
                    <div id="maintenanceSettingsContent" class="loading">
                        –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è...
                    </div>
                </div>

                <!-- –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ -->
                <div id="settingsStressTest" class="settings-section" style="display: none;">
                    <h4>üß™ –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h4>
                    <div id="stressTestSettingsContent">
                        <div class="form-group">
                            <label>üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</label>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 10px;">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                    <div>
                                        <label for="stressTestType">–¢–∏–ø —Ç–µ—Å—Ç–∞:</label>
                                        <select id="stressTestType" onchange="updateStressTestConfig()">
                                            <option value="applications">–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫</option>
                                            <option value="users">–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</option>
                                            <option value="notifications">–û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</option>
                                            <option value="mixed">–°–º–µ—à–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="stressTestCount">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π:</label>
                                        <input type="number" id="stressTestCount" value="100" min="1" max="10000">
                                    </div>
                                    <div>
                                        <label for="stressTestDelay">–ó–∞–¥–µ—Ä–∂–∫–∞ (–º—Å):</label>
                                        <input type="number" id="stressTestDelay" value="100" min="0" max="5000">
                                    </div>
                                    <div>
                                        <label for="stressTestConcurrency">–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å:</label>
                                        <input type="number" id="stressTestConcurrency" value="5" min="1" max="50">
                                    </div>
                                </div>
                                <div style="margin-top: 15px;">
                                    <button class="btn btn-primary" onclick="startStressTest()" id="startStressTestBtn">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
                                    <button class="btn btn-danger" onclick="stopStressTest()" id="stopStressTestBtn" disabled>‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                                    <button class="btn btn-info" onclick="clearStressTestResults()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</label>
                            <div id="stressTestResults" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 10px; min-height: 200px;">
                                <p style="color: #666; text-align: center;">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <div id="createUserModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; max-width: 500px; width: 90%;">
                <h3>–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                <form id="createUserForm">
                    <div class="form-group">
                        <label for="newUsername">–õ–æ–≥–∏–Ω</label>
                        <input type="text" id="newUsername" required>
                    </div>
                    <div class="form-group">
                        <label for="newEmail">Email</label>
                        <input type="email" id="newEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="newFullName">–ü–æ–ª–Ω–æ–µ –∏–º—è</label>
                        <input type="text" id="newFullName" required>
                    </div>
                    <div class="form-group">
                        <label for="newPassword">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="newPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="newRole">–†–æ–ª—å</label>
                        <select id="newRole" required>
                            <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                            <option value="manager">–ú–µ–Ω–µ–¥–∂–µ—Ä</option>
                            <option value="viewer">–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å</option>
                        </select>
                    </div>
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="hideCreateUserForm()">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                        <button type="submit" class="btn btn-primary">
                            –°–æ–∑–¥–∞—Ç—å
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
        <div id="createScheduleModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto;">
                <h3>–°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h3>
                <form id="createScheduleForm">
                    <div class="form-group">
                        <label for="scheduleName">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</label>
                        <input type="text" id="scheduleName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ï–∂–µ–º–µ—Å—è—á–Ω–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="scheduleType">–¢–∏–ø —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</label>
                        <select id="scheduleType" required>
                            <option value="application_open">–ù–∞—á–∞–ª–æ –ø—Ä–∏–µ–º–∞ –∑–∞—è–≤–æ–∫</option>
                            <option value="application_closing_soon">–°–∫–æ—Ä–æ –æ–∫–æ–Ω—á–∞–Ω–∏–µ</option>
                            <option value="application_closed">–ü—Ä–∏–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω</option>
                            <option value="application_reminder">–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –∑–∞—è–≤–∫–µ</option>
                            <option value="system_announcement">–°–∏—Å—Ç–µ–º–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="scheduleTitle">–ó–∞–≥–æ–ª–æ–≤–æ–∫</label>
                        <input type="text" id="scheduleTitle" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="scheduleMessage">–°–æ–æ–±—â–µ–Ω–∏–µ</label>
                        <textarea id="scheduleMessage" rows="3" placeholder="–¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="scheduleFrequency">–ß–∞—Å—Ç–æ—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏</label>
                        <select id="scheduleFrequency" onchange="updateScheduleConfig()" required>
                            <option value="once">–û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ</option>
                            <option value="daily">–ï–∂–µ–¥–Ω–µ–≤–Ω–æ</option>
                            <option value="weekly">–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ</option>
                            <option value="monthly">–ï–∂–µ–º–µ—Å—è—á–Ω–æ</option>
                        </select>
                    </div>
                    
                    <div id="scheduleConfig">
                        <!-- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="scheduleActive" checked>
                            –ê–∫—Ç–∏–≤–Ω–æ
                        </label>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" class="btn btn-secondary" onclick="hideCreateScheduleForm()">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                        <button type="submit" class="btn btn-primary">
                            –°–æ–∑–¥–∞—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        const SMARTAPP_URL = 'http://localhost:8082';
        let currentUser = null;
        let authToken = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω
            authToken = localStorage.getItem('auth_token');
            if (authToken) {
                checkAuth();
            }
        });

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        async function checkAuth() {
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/auth/me`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        currentUser = data.user;
                        showMainInterface();
                        loadUsers();
                        loadProfile();
                    } else {
                        showLoginForm();
                    }
                } else {
                    showLoginForm();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', error);
                showLoginForm();
            }
        }

        // –ü–æ–∫–∞–∑ —Ñ–æ—Ä–º—ã –≤—Ö–æ–¥–∞
        function showLoginForm() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('mainInterface').style.display = 'none';
            authToken = null;
            localStorage.removeItem('auth_token');
        }

        // –ü–æ–∫–∞–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function showMainInterface() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('mainInterface').style.display = 'block';
        }

        // –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
        document.getElementById('loginFormElement').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                });

                const data = await response.json();
                
                if (data.success) {
                    authToken = data.token;
                    currentUser = data.user;
                    localStorage.setItem('auth_token', authToken);
                    showMainInterface();
                    loadUsers();
                    loadProfile();
                } else {
                    showError('loginError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
                showError('loginError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        });

        // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        async function logout() {
            try {
                await fetch(`${SMARTAPP_URL}/api/auth/logout`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
            }
            
            showLoginForm();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        async function loadUsers() {
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/users`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        displayUsers(data.users);
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:', error);
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function displayUsers(users) {
            const table = document.getElementById('usersTable');
            
            if (users.length === 0) {
                table.innerHTML = '<p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                return;
            }

            let html = `
                <table class="users-table">
                    <thead>
                        <tr>
                            <th>–õ–æ–≥–∏–Ω</th>
                            <th>Email</th>
                            <th>–ü–æ–ª–Ω–æ–µ –∏–º—è</th>
                            <th>–†–æ–ª—å</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–°–æ–∑–¥–∞–Ω</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            users.forEach(user => {
                html += `
                    <tr>
                        <td>${user.username}</td>
                        <td>${user.email}</td>
                        <td>${user.full_name}</td>
                        <td><span class="role-badge role-${user.role}">${user.role}</span></td>
                        <td><span class="status-badge status-${user.status}">${user.status}</span></td>
                        <td>${new Date(user.created_at).toLocaleDateString()}</td>
                        <td>
                            <button class="btn btn-warning" onclick="editUser('${user.id}')">–ò–∑–º–µ–Ω–∏—Ç—å</button>
                            ${user.role !== 'admin' ? `<button class="btn btn-danger" onclick="deleteUser('${user.id}')">–£–¥–∞–ª–∏—Ç—å</button>` : ''}
                        </td>
                    </tr>
                `;
            });

            html += '</tbody></table>';
            table.innerHTML = html;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è
        async function loadProfile() {
            const profileDiv = document.getElementById('userProfile');
            profileDiv.innerHTML = `
                <h4>${currentUser.full_name}</h4>
                <p><strong>–õ–æ–≥–∏–Ω:</strong> ${currentUser.username}</p>
                <p><strong>Email:</strong> ${currentUser.email}</p>
                <p><strong>–†–æ–ª—å:</strong> ${currentUser.role}</p>
                <p><strong>–°—Ç–∞—Ç—É—Å:</strong> ${currentUser.status}</p>
                <p><strong>–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:</strong></p>
                <div class="permissions-list">
                    ${currentUser.permissions.map(perm => `<div class="permission-item">${perm}</div>`).join('')}
                </div>
            `;
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        document.getElementById('createUserForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const userData = {
                username: document.getElementById('newUsername').value,
                email: document.getElementById('newEmail').value,
                full_name: document.getElementById('newFullName').value,
                password: document.getElementById('newPassword').value,
                role: document.getElementById('newRole').value
            };

            try {
                const response = await fetch(`${SMARTAPP_URL}/api/users`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify(userData)
                });

                const data = await response.json();
                
                if (data.success) {
                    hideCreateUserForm();
                    loadUsers();
                    showSuccess('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ');
                } else {
                    showError('createUserError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
                showError('createUserError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        });

        // –ü–æ–∫–∞–∑ —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function showCreateUserForm() {
            document.getElementById('createUserModal').style.display = 'block';
        }

        // –°–∫—Ä—ã—Ç–∏–µ —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function hideCreateUserForm() {
            document.getElementById('createUserModal').style.display = 'none';
            document.getElementById('createUserForm').reset();
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function deleteUser(userId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')) {
                return;
            }

            try {
                const response = await fetch(`${SMARTAPP_URL}/api/users/${userId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                const data = await response.json();
                
                if (data.success) {
                    loadUsers();
                    showSuccess('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω');
                } else {
                    showError('usersError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
                showError('usersError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function showTab(tabName) {
            console.log('–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É:', tabName);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName + 'Tab').classList.add('active');
            event.target.classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏
            if (tabName === 'dashboard') {
                loadDashboard();
            } else if (tabName === 'applications') {
                loadApplications();
            } else if (tabName === 'users') {
                loadUsers();
            } else if (tabName === 'statistics') {
                loadStatistics();
            } else if (tabName === 'logs') {
                loadLogs();
            } else if (tabName === 'notifications') {
                console.log('–ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π...');
                loadNotificationSchedules();
            } else if (tabName === 'periods') {
                // –ü–µ—Ä–∏–æ–¥—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –æ–∫–Ω–µ
            } else if (tabName === 'config') {
                loadConfig();
            } else if (tabName === 'settings') {
                loadSettings();
            } else if (tabName === 'profile') {
                loadUserProfile();
            }
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function showError(elementId, message) {
            const errorDiv = document.getElementById(elementId);
            if (errorDiv) {
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
                setTimeout(() => {
                    errorDiv.style.display = 'none';
                }, 5000);
            }
        }

        function showSuccess(message) {
            // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
            const successDiv = document.createElement('div');
            successDiv.className = 'success';
            successDiv.textContent = message;
            successDiv.style.position = 'fixed';
            successDiv.style.top = '20px';
            successDiv.style.right = '20px';
            successDiv.style.zIndex = '1001';
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                document.body.removeChild(successDiv);
            }, 3000);
        }

        // ==================== –§–£–ù–ö–¶–ò–ò –†–ê–°–ü–ò–°–ê–ù–ò–Ø –£–í–ï–î–û–ú–õ–ï–ù–ò–ô ====================

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        async function loadNotificationSchedules() {
            console.log('–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π...');
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/notifications/schedules`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    console.log('–î–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π:', data);
                    if (data.success) {
                        displayNotificationSchedules(data.schedules);
                    } else {
                        document.getElementById('schedulesTable').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π</div>';
                    }
                } else {
                    console.error('–û—à–∏–±–∫–∞ HTTP:', response.status);
                    document.getElementById('schedulesTable').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º</div>';
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π:', error);
                document.getElementById('schedulesTable').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º</div>';
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function displayNotificationSchedules(schedules) {
            const container = document.getElementById('schedulesTable');
            
            if (schedules.length === 0) {
                container.innerHTML = '<div class="no-data">–†–∞—Å–ø–∏—Å–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }

            let html = `
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                <th>–¢–∏–ø</th>
                                <th>–ß–∞—Å—Ç–æ—Ç–∞</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–°–ª–µ–¥—É—é—â–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            schedules.forEach(schedule => {
                const statusClass = schedule.is_active ? 'status-active' : 'status-inactive';
                const statusText = schedule.is_active ? '–ê–∫—Ç–∏–≤–Ω–æ' : '–ù–µ–∞–∫—Ç–∏–≤–Ω–æ';
                const nextSend = schedule.next_send ? new Date(schedule.next_send).toLocaleString('ru-RU') : '–ù–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ';
                
                html += `
                    <tr>
                        <td>${schedule.name}</td>
                        <td>${getNotificationTypeText(schedule.type)}</td>
                        <td>${getScheduleTypeText(schedule.schedule_type)}</td>
                        <td><span class="${statusClass}">${statusText}</span></td>
                        <td>${nextSend}</td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="testSchedule('${schedule.id}')">–¢–µ—Å—Ç</button>
                            <button class="btn btn-sm btn-secondary" onclick="editSchedule('${schedule.id}')">–ò–∑–º–µ–Ω–∏—Ç—å</button>
                            <button class="btn btn-sm btn-danger" onclick="deleteSchedule('${schedule.id}')">–£–¥–∞–ª–∏—Ç—å</button>
                        </td>
                    </tr>
                `;
            });

            html += `
                        </tbody>
                    </table>
                </div>
            `;

            container.innerHTML = html;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Ç–∏–ø–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function getNotificationTypeText(type) {
            const types = {
                'application_open': '–ù–∞—á–∞–ª–æ –ø—Ä–∏–µ–º–∞',
                'application_closing_soon': '–°–∫–æ—Ä–æ –æ–∫–æ–Ω—á–∞–Ω–∏–µ',
                'application_closed': '–ü—Ä–∏–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω',
                'application_reminder': '–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ',
                'system_announcement': '–û–±—ä—è–≤–ª–µ–Ω–∏–µ'
            };
            return types[type] || type;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Ç–∏–ø–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        function getScheduleTypeText(type) {
            const types = {
                'once': '–û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ',
                'daily': '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ',
                'weekly': '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ',
                'monthly': '–ï–∂–µ–º–µ—Å—è—á–Ω–æ'
            };
            return types[type] || type;
        }

        // –ü–æ–∫–∞–∑ —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        function showCreateScheduleForm() {
            document.getElementById('createScheduleModal').style.display = 'block';
            updateScheduleConfig();
        }

        // –°–∫—Ä—ã—Ç–∏–µ —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        function hideCreateScheduleForm() {
            document.getElementById('createScheduleModal').style.display = 'none';
            document.getElementById('createScheduleForm').reset();
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            delete document.getElementById('createScheduleForm').dataset.editId;
            document.querySelector('#createScheduleModal h3').textContent = '–°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π';
            document.querySelector('#createScheduleForm button[type="submit"]').textContent = '–°–æ–∑–¥–∞—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ';
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        function updateScheduleConfig() {
            const frequency = document.getElementById('scheduleFrequency').value;
            const configDiv = document.getElementById('scheduleConfig');
            
            let html = '';
            
            if (frequency === 'once') {
                html = `
                    <div class="form-group">
                        <label for="onceDate">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏</label>
                        <input type="datetime-local" id="onceDate" required>
                    </div>
                `;
            } else if (frequency === 'daily') {
                html = `
                    <div class="form-group">
                        <label for="dailyTime">–í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏</label>
                        <input type="time" id="dailyTime" value="09:00" required>
                    </div>
                `;
            } else if (frequency === 'weekly') {
                html = `
                    <div class="form-group">
                        <label for="weeklyDay">–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏</label>
                        <select id="weeklyDay" required>
                            <option value="0">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</option>
                            <option value="1">–í—Ç–æ—Ä–Ω–∏–∫</option>
                            <option value="2">–°—Ä–µ–¥–∞</option>
                            <option value="3">–ß–µ—Ç–≤–µ—Ä–≥</option>
                            <option value="4">–ü—è—Ç–Ω–∏—Ü–∞</option>
                            <option value="5">–°—É–±–±–æ—Ç–∞</option>
                            <option value="6">–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="weeklyTime">–í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏</label>
                        <input type="time" id="weeklyTime" value="09:00" required>
                    </div>
                `;
            } else if (frequency === 'monthly') {
                html = `
                    <div class="form-group">
                        <label for="monthlyDay">–î–µ–Ω—å –º–µ—Å—è—Ü–∞</label>
                        <input type="number" id="monthlyDay" min="1" max="31" value="15" required>
                    </div>
                    <div class="form-group">
                        <label for="monthlyTime">–í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏</label>
                        <input type="time" id="monthlyTime" value="09:00" required>
                    </div>
                `;
            }
            
            configDiv.innerHTML = html;
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        document.getElementById('createScheduleForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const frequency = document.getElementById('scheduleFrequency').value;
            let scheduleConfig = {};
            
            if (frequency === 'once') {
                const sendTime = document.getElementById('onceDate').value;
                scheduleConfig = { scheduled_at: sendTime };
            } else if (frequency === 'daily') {
                scheduleConfig = {
                    time: document.getElementById('dailyTime').value
                };
            } else if (frequency === 'weekly') {
                scheduleConfig = {
                    day_of_week: parseInt(document.getElementById('weeklyDay').value),
                    time: document.getElementById('weeklyTime').value
                };
            } else if (frequency === 'monthly') {
                scheduleConfig = {
                    day_of_month: parseInt(document.getElementById('monthlyDay').value),
                    time: document.getElementById('monthlyTime').value
                };
            }
            
            const scheduleData = {
                name: document.getElementById('scheduleName').value,
                schedule_type: document.getElementById('scheduleType').value,
                title: document.getElementById('scheduleTitle').value,
                message: document.getElementById('scheduleMessage').value,
                frequency: frequency,
                schedule_config: scheduleConfig,
                is_active: document.getElementById('scheduleActive').checked
            };
            
            try {
                const editId = document.getElementById('createScheduleForm').dataset.editId;
                const url = editId ? 
                    `${SMARTAPP_URL}/api/notifications/schedules/${editId}` : 
                    `${SMARTAPP_URL}/api/notifications/schedules`;
                const method = editId ? 'PUT' : 'POST';
                
                const response = await fetch(url, {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify(scheduleData)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        hideCreateScheduleForm();
                        loadNotificationSchedules();
                        showSuccess(editId ? '–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω–æ' : '–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å–æ–∑–¥–∞–Ω–æ');
                    } else {
                        showError('schedulesError', data.error || '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è');
                    }
                } else {
                    showError('schedulesError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:', error);
                showError('schedulesError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        });

        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        async function testSchedule(scheduleId) {
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/notifications/schedules/${scheduleId}/test`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        showSuccess('–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ');
                    } else {
                        showError('schedulesError', data.error || '–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è');
                    }
                } else {
                    showError('schedulesError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:', error);
                showError('schedulesError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        async function editSchedule(scheduleId) {
            try {
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
                const response = await fetch(`/api/notifications/schedules/${scheduleId}`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${getAuthToken()}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const schedule = await response.json();
                
                // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –¥–∞–Ω–Ω—ã–º–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
                document.getElementById('scheduleName').value = schedule.name || '';
                document.getElementById('scheduleType').value = schedule.schedule_type || 'application_open';
                document.getElementById('scheduleTitle').value = schedule.title || '';
                document.getElementById('scheduleMessage').value = schedule.message || '';
                document.getElementById('scheduleFrequency').value = schedule.frequency || 'once';
                document.getElementById('scheduleActive').checked = schedule.is_active !== false;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
                updateScheduleConfig();
                
                // –ó–∞–ø–æ–ª–Ω—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
                if (schedule.frequency === 'once' && schedule.scheduled_at) {
                    const date = new Date(schedule.scheduled_at);
                    document.getElementById('onceDate').value = date.toISOString().slice(0, 16);
                } else if (schedule.frequency === 'daily' && schedule.time) {
                    document.getElementById('dailyTime').value = schedule.time;
                } else if (schedule.frequency === 'weekly' && schedule.day_of_week !== undefined && schedule.time) {
                    document.getElementById('weeklyDay').value = schedule.day_of_week;
                    document.getElementById('weeklyTime').value = schedule.time;
                } else if (schedule.frequency === 'monthly' && schedule.day_of_month !== undefined && schedule.time) {
                    document.getElementById('monthlyDay').value = schedule.day_of_month;
                    document.getElementById('monthlyTime').value = schedule.time;
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
                showCreateScheduleForm();
                
                // –ò–∑–º–µ–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∫–Ω–æ–ø–∫—É –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                document.querySelector('#createScheduleModal h3').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è';
                document.querySelector('#createScheduleForm button[type="submit"]').textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è';
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                document.getElementById('createScheduleForm').dataset.editId = scheduleId;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:', error);
                showError('schedulesError', '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è');
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        async function deleteSchedule(scheduleId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ?')) {
                return;
            }
            
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/notifications/schedules/${scheduleId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        loadNotificationSchedules();
                        showSuccess('–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ');
                    } else {
                        showError('schedulesError', data.error || '–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è');
                    }
                } else {
                    showError('schedulesError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:', error);
                showError('schedulesError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // ==================== –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ë–û–¢–û–ú ====================

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞
        async function loadDashboard() {
            try {
                const [botStatus, statistics] = await Promise.all([
                    fetch(`${SMARTAPP_URL}/api/bot/status`, {
                        headers: { 'Authorization': `Bearer ${authToken}` }
                    }).then(r => r.json()),
                    fetch(`${SMARTAPP_URL}/api/statistics`, {
                        headers: { 'Authorization': `Bearer ${authToken}` }
                    }).then(r => r.json())
                ]);

                const dashboardHtml = `
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        <div class="dashboard-card" style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid #28a745;">
                            <h4>ü§ñ –°—Ç–∞—Ç—É—Å –±–æ—Ç–∞</h4>
                            <p><strong>–°–æ—Å—Ç–æ—è–Ω–∏–µ:</strong> <span style="color: ${botStatus.bot_status === 'running' ? '#28a745' : '#dc3545'}">${botStatus.bot_status === 'running' ? '–ó–∞–ø—É—â–µ–Ω' : '–û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}</span></p>
                            <p><strong>–ü—Ä–æ—Ü–µ—Å—Å–æ–≤:</strong> ${botStatus.processes ? botStatus.processes.length : 0}</p>
                        </div>
                        
                        <div class="dashboard-card" style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid #007bff;">
                            <h4>üìä –ó–∞—è–≤–∫–∏</h4>
                            <p><strong>–í—Å–µ–≥–æ:</strong> ${statistics.statistics?.applications?.total || 0}</p>
                            <p><strong>–°–µ–≥–æ–¥–Ω—è:</strong> ${statistics.statistics?.applications?.today || 0}</p>
                            <p><strong>–ó–∞ –Ω–µ–¥–µ–ª—é:</strong> ${statistics.statistics?.applications?.this_week || 0}</p>
                        </div>
                        
                        <div class="dashboard-card" style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid #ffc107;">
                            <h4>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h4>
                            <p><strong>–í—Å–µ–≥–æ:</strong> ${statistics.statistics?.users?.total || 0}</p>
                            <p><strong>–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ–≥–æ–¥–Ω—è:</strong> ${statistics.statistics?.users?.active_today || 0}</p>
                            <p><strong>–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞ –Ω–µ–¥–µ–ª—é:</strong> ${statistics.statistics?.users?.active_this_week || 0}</p>
                        </div>
                        
                        <div class="dashboard-card" style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid #17a2b8;">
                            <h4>üíª –°–∏—Å—Ç–µ–º–∞</h4>
                            <p><strong>CPU:</strong> ${botStatus.system?.cpu_percent || 0}%</p>
                            <p><strong>–ü–∞–º—è—Ç—å:</strong> ${botStatus.system?.memory_percent || 0}%</p>
                            <p><strong>–î–∏—Å–∫:</strong> ${botStatus.system?.disk_percent || 0}%</p>
                        </div>
                    </div>
                `;
                
                document.getElementById('dashboardContent').innerHTML = dashboardHtml;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞:', error);
                document.getElementById('dashboardContent').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞</div>';
            }
        }


        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        async function loadStatistics() {
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/statistics`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const stats = data.statistics;
                    
                    const statsHtml = `
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <div class="stats-card" style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                <h4>üìù –ó–∞—è–≤–∫–∏</h4>
                                <p><strong>–í—Å–µ–≥–æ:</strong> ${stats.applications?.total || 0}</p>
                                <p><strong>–°–µ–≥–æ–¥–Ω—è:</strong> ${stats.applications?.today || 0}</p>
                                <p><strong>–ó–∞ –Ω–µ–¥–µ–ª—é:</strong> ${stats.applications?.this_week || 0}</p>
                                <p><strong>–ó–∞ –º–µ—Å—è—Ü:</strong> ${stats.applications?.this_month || 0}</p>
                            </div>
                            
                            <div class="stats-card" style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                <h4>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h4>
                                <p><strong>–í—Å–µ–≥–æ:</strong> ${stats.users?.total || 0}</p>
                                <p><strong>–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ–≥–æ–¥–Ω—è:</strong> ${stats.users?.active_today || 0}</p>
                                <p><strong>–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞ –Ω–µ–¥–µ–ª—é:</strong> ${stats.users?.active_this_week || 0}</p>
                            </div>
                            
                            <div class="stats-card" style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                <h4>üèÜ –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h4>
                                ${stats.popular_directions ? stats.popular_directions.map(dir => 
                                    `<p><strong>${dir.name}:</strong> ${dir.count} –∑–∞—è–≤–æ–∫</p>`
                                ).join('') : '<p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</p>'}
                            </div>
                            
                            <div class="stats-card" style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                <h4>üíö –ó–¥–æ—Ä–æ–≤—å–µ —Å–∏—Å—Ç–µ–º—ã</h4>
                                <p><strong>–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞:</strong> ${stats.system_health?.bot_uptime || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                                <p><strong>–ü–æ—Å–ª–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞:</strong> ${stats.system_health?.last_error || '–ù–µ—Ç'}</p>
                                <p><strong>–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞:</strong> ${stats.system_health?.response_time || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                            </div>
                        </div>
                    `;
                    
                    document.getElementById('statisticsContent').innerHTML = statsHtml;
                } else {
                    document.getElementById('statisticsContent').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</div>';
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
                document.getElementById('statisticsContent').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º</div>';
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ–≤
        async function loadLogs() {
            try {
                const level = document.getElementById('logLevel').value;
                const lines = document.getElementById('logLines').value;
                
                const response = await fetch(`${SMARTAPP_URL}/api/logs?level=${level}&lines=${lines}`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    
                    const logsHtml = `
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
                            <strong>–í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫:</strong> ${data.total_lines} | <strong>–£—Ä–æ–≤–µ–Ω—å:</strong> ${data.level}
                        </div>
                        <div style="background: #000; color: #0f0; padding: 15px; border-radius: 5px; font-family: monospace; font-size: 12px; max-height: 500px; overflow-y: auto;">
                            ${data.logs.map(log => `<div>${log}</div>`).join('')}
                        </div>
                    `;
                    
                    document.getElementById('logsContent').innerHTML = logsHtml;
                } else {
                    document.getElementById('logsContent').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ–≤</div>';
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ–≤:', error);
                document.getElementById('logsContent').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º</div>';
            }
        }

        // ==================== –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ï–ô ====================

        let currentConfig = null;

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        async function loadConfig() {
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/config`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    currentConfig = data.config;
                    loadBasicConfig();
                } else {
                    showError('configError', '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:', error);
                showError('configError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –ü–æ–∫–∞–∑ —Ä–∞–∑–¥–µ–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        function showConfigSection(section) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ä–∞–∑–¥–µ–ª—ã
            document.querySelectorAll('.config-section').forEach(div => {
                div.style.display = 'none';
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª
            document.getElementById('config' + section.charAt(0).toUpperCase() + section.slice(1)).style.display = 'block';
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞
            switch(section) {
                case 'basic':
                    loadBasicConfig();
                    break;
                case 'directions':
                    loadDirectionsConfig();
                    break;
                case 'oke':
                    loadOkeConfig();
                    break;
                case 'positions':
                    loadPositionsConfig();
                    break;
                case 'backup':
                    loadBackupConfig();
                    break;
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
        async function loadBasicConfig() {
            if (!currentConfig) return;
            
            const botSettings = currentConfig.bot_settings || {};
            const html = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <form id="basicConfigForm">
                        <div class="form-group">
                            <label for="botName">–ù–∞–∑–≤–∞–Ω–∏–µ –±–æ—Ç–∞:</label>
                            <input type="text" id="botName" value="${botSettings.bot_name || ''}" required>
                        </div>
                        <div class="form-group">
                            <label for="botDescription">–û–ø–∏—Å–∞–Ω–∏–µ –±–æ—Ç–∞:</label>
                            <textarea id="botDescription" rows="3">${botSettings.bot_description || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="apiUrl">API URL:</label>
                            <input type="url" id="apiUrl" value="${botSettings.api_base_url || ''}" required>
                        </div>
                        <div class="form-group">
                            <label for="botId">Bot ID:</label>
                            <input type="text" id="botId" value="${botSettings.bot_id || ''}" required>
                        </div>
                        <div class="form-group">
                            <label for="secretKey">Secret Key:</label>
                            <input type="password" id="secretKey" value="${botSettings.secret_key || ''}" required>
                        </div>
                        <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </form>
                </div>
            `;
            
            document.getElementById('basicConfigContent').innerHTML = html;
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã
            document.getElementById('basicConfigForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                await saveBasicConfig();
            });
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
        async function saveBasicConfig() {
            try {
                const botSettings = {
                    bot_name: document.getElementById('botName').value,
                    bot_description: document.getElementById('botDescription').value,
                    api_base_url: document.getElementById('apiUrl').value,
                    bot_id: document.getElementById('botId').value,
                    secret_key: document.getElementById('secretKey').value
                };
                
                currentConfig.bot_settings = botSettings;
                
                const response = await fetch(`${SMARTAPP_URL}/api/config`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify(currentConfig)
                });
                
                const data = await response.json();
                if (data.success) {
                    showSuccess('–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
                } else {
                    showError('configError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫:', error);
                showError('configError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
        async function loadDirectionsConfig() {
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/config/directions`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    displayDirectionsConfig(data.directions);
                } else {
                    document.getElementById('directionsConfigContent').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π</div>';
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π:', error);
                document.getElementById('directionsConfigContent').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º</div>';
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
        function displayDirectionsConfig(directions) {
            let html = '';
            
            for (const [location, directionList] of Object.entries(directions)) {
                html += `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <h5>${location}</h5>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 15px;">
                            ${directionList.map(direction => `
                                <span style="background: #e9ecef; padding: 5px 10px; border-radius: 5px; display: flex; align-items: center; gap: 5px;">
                                    ${direction}
                                    <button onclick="removeDirection('${location}', '${direction}')" style="background: none; border: none; color: #dc3545; cursor: pointer;">‚ùå</button>
                                </span>
                            `).join('')}
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="newDirection_${location}" placeholder="–ù–æ–≤–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ" style="flex: 1;">
                            <button onclick="addDirection('${location}')" class="btn btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                        </div>
                    </div>
                `;
            }
            
            document.getElementById('directionsConfigContent').innerHTML = html;
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        async function addDirection(location) {
            const input = document.getElementById(`newDirection_${location}`);
            const direction = input.value.trim();
            
            if (!direction) {
                showError('configError', '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è');
                return;
            }
            
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/config/directions`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ location, direction })
                });
                
                const data = await response.json();
                if (data.success) {
                    showSuccess(data.message);
                    input.value = '';
                    loadDirectionsConfig();
                } else {
                    showError('configError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:', error);
                showError('configError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        async function removeDirection(location, direction) {
            if (!confirm(`–£–¥–∞–ª–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "${direction}" –¥–ª—è ${location}?`)) {
                return;
            }
            
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/config/directions?location=${encodeURIComponent(location)}&direction=${encodeURIComponent(direction)}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                if (data.success) {
                    showSuccess(data.message);
                    loadDirectionsConfig();
                } else {
                    showError('configError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:', error);
                showError('configError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –û–ö–≠
        async function loadOkeConfig() {
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/config/oke`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    displayOkeConfig(data.oke);
                } else {
                    document.getElementById('okeConfigContent').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –û–ö–≠</div>';
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –û–ö–≠:', error);
                document.getElementById('okeConfigContent').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º</div>';
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –û–ö–≠
        function displayOkeConfig(oke) {
            let html = '';
            
            for (const [location, okeList] of Object.entries(oke)) {
                html += `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <h5>${location}</h5>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 15px;">
                            ${okeList.map(okeItem => `
                                <span style="background: #e9ecef; padding: 5px 10px; border-radius: 5px; display: flex; align-items: center; gap: 5px;">
                                    ${okeItem}
                                    <button onclick="removeOke('${location}', '${okeItem}')" style="background: none; border: none; color: #dc3545; cursor: pointer;">‚ùå</button>
                                </span>
                            `).join('')}
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="newOke_${location}" placeholder="–ù–æ–≤—ã–π –û–ö–≠" style="flex: 1;">
                            <button onclick="addOke('${location}')" class="btn btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                        </div>
                    </div>
                `;
            }
            
            document.getElementById('okeConfigContent').innerHTML = html;
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –û–ö–≠
        async function addOke(location) {
            const input = document.getElementById(`newOke_${location}`);
            const oke = input.value.trim();
            
            if (!oke) {
                showError('configError', '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –û–ö–≠');
                return;
            }
            
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/config/oke`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ location, oke })
                });
                
                const data = await response.json();
                if (data.success) {
                    showSuccess(data.message);
                    input.value = '';
                    loadOkeConfig();
                } else {
                    showError('configError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –û–ö–≠:', error);
                showError('configError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –û–ö–≠
        async function removeOke(location, oke) {
            if (!confirm(`–£–¥–∞–ª–∏—Ç—å –û–ö–≠ "${oke}" –¥–ª—è ${location}?`)) {
                return;
            }
            
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/config/oke?location=${encodeURIComponent(location)}&oke=${encodeURIComponent(oke)}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                if (data.success) {
                    showSuccess(data.message);
                    loadOkeConfig();
                } else {
                    showError('configError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –û–ö–≠:', error);
                showError('configError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π
        async function loadPositionsConfig() {
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/config/positions`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    displayPositionsConfig(data.positions);
                } else {
                    document.getElementById('positionsConfigContent').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π</div>';
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π:', error);
                document.getElementById('positionsConfigContent').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º</div>';
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π
        function displayPositionsConfig(positions) {
            const html = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h5>–°–ø–∏—Å–æ–∫ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π</h5>
                    <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 15px;">
                        ${positions.map(position => `
                            <span style="background: #e9ecef; padding: 5px 10px; border-radius: 5px; display: flex; align-items: center; gap: 5px;">
                                ${position}
                                <button onclick="removePosition('${position}')" style="background: none; border: none; color: #dc3545; cursor: pointer;">‚ùå</button>
                            </span>
                        `).join('')}
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="newPosition" placeholder="–ù–æ–≤–∞—è –¥–æ–ª–∂–Ω–æ—Å—Ç—å" style="flex: 1;">
                        <button onclick="addPosition()" class="btn btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>
                </div>
            `;
            
            document.getElementById('positionsConfigContent').innerHTML = html;
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏
        async function addPosition() {
            const input = document.getElementById('newPosition');
            const position = input.value.trim();
            
            if (!position) {
                showError('configError', '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏');
                return;
            }
            
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/config/positions`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ position })
                });
                
                const data = await response.json();
                if (data.success) {
                    showSuccess(data.message);
                    input.value = '';
                    loadPositionsConfig();
                } else {
                    showError('configError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–ª–∂–Ω–æ—Å—Ç–∏:', error);
                showError('configError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏
        async function removePosition(position) {
            if (!confirm(`–£–¥–∞–ª–∏—Ç—å –¥–æ–ª–∂–Ω–æ—Å—Ç—å "${position}"?`)) {
                return;
            }
            
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/config/positions?position=${encodeURIComponent(position)}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                if (data.success) {
                    showSuccess(data.message);
                    loadPositionsConfig();
                } else {
                    showError('configError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥–æ–ª–∂–Ω–æ—Å—Ç–∏:', error);
                showError('configError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π
        async function loadBackupConfig() {
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/config/backup`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    displayBackupConfig(data.backups);
                } else {
                    document.getElementById('backupConfigContent').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π</div>';
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π:', error);
                document.getElementById('backupConfigContent').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º</div>';
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π
        function displayBackupConfig(backups) {
            const html = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h5>–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</h5>
                    ${backups.length > 0 ? `
                        <div style="max-height: 400px; overflow-y: auto;">
                            ${backups.map(backup => `
                                <div style="background: white; padding: 15px; border-radius: 5px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <strong>${backup.filename}</strong><br>
                                        <small>–°–æ–∑–¥–∞–Ω–∞: ${new Date(backup.created).toLocaleString()}</small><br>
                                        <small>–†–∞–∑–º–µ—Ä: ${(backup.size / 1024).toFixed(1)} KB</small>
                                    </div>
                                    <button onclick="restoreBackup('${backup.path}')" class="btn btn-warning">üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                                </div>
                            `).join('')}
                        </div>
                    ` : '<p>–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>'}
                </div>
            `;
            
            document.getElementById('backupConfigContent').innerHTML = html;
        }

        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
        async function restoreBackup(backupPath) {
            if (!confirm('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ —ç—Ç–æ–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏? –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∫–∞–∫ backup.')) {
                return;
            }
            
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/config/backup/restore`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ backup_file: backupPath })
                });
                
                const data = await response.json();
                if (data.success) {
                    showSuccess(data.message);
                    loadConfig(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
                } else {
                    showError('configError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:', error);
                showError('configError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // ==================== –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ù–ê–°–¢–†–û–ô–ö–ê–ú–ò ====================

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        async function loadSettings() {
            loadGeneralSettings();
            loadStressTestSettings();
        }

        // –ü–æ–∫–∞–∑ —Ä–∞–∑–¥–µ–ª–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function showSettingsSection(section) {
            console.log('–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å–µ–∫—Ü–∏—é –Ω–∞—Å—Ç—Ä–æ–µ–∫:', section);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ä–∞–∑–¥–µ–ª—ã
            document.querySelectorAll('.settings-section').forEach(div => {
                div.style.display = 'none';
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª
            let sectionId;
            if (section === 'stresstest') {
                sectionId = 'settingsStressTest';
            } else {
                sectionId = 'settings' + section.charAt(0).toUpperCase() + section.slice(1);
            }
            console.log('–ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é:', sectionId);
            const element = document.getElementById(sectionId);
            if (element) {
                element.style.display = 'block';
            } else {
                console.error('–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω:', sectionId);
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞
            switch(section) {
                case 'general':
                    loadGeneralSettings();
                    break;
                case 'security':
                    loadSecuritySettings();
                    break;
                case 'notifications':
                    loadNotificationSettings();
                    break;
                case 'logging':
                    loadLoggingSettings();
                    break;
                case 'maintenance':
                    loadMaintenanceSettings();
                    break;
                case 'stresstest':
                    loadStressTestSettings();
                    break;
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function loadGeneralSettings() {
            const html = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h5>üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞</h5>
                    <div class="form-group">
                        <label for="serverPort">–ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞:</label>
                        <input type="number" id="serverPort" value="5006" min="1000" max="65535">
                        <small>–ü–æ—Ä—Ç –¥–ª—è –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ (—Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞)</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="serverHost">–•–æ—Å—Ç —Å–µ—Ä–≤–µ—Ä–∞:</label>
                        <select id="serverHost">
                            <option value="0.0.0.0">0.0.0.0 (–≤—Å–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã)</option>
                            <option value="127.0.0.1">127.0.0.1 (—Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ)</option>
                            <option value="localhost">localhost</option>
                        </select>
                    </div>

                    <h5>ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞</h5>
                    <div class="form-group">
                        <label for="botDebugMode">–†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏:</label>
                        <input type="checkbox" id="botDebugMode" checked>
                        <small>–í–∫–ª—é—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="botAutoRestart">–ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö:</label>
                        <input type="checkbox" id="botAutoRestart">
                        <small>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å –±–æ—Ç–∞ –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö</small>
                    </div>

                    <h5>üìä –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞</h5>
                    <div class="form-group">
                        <label for="dashboardRefreshInterval">–ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (—Å–µ–∫):</label>
                        <input type="number" id="dashboardRefreshInterval" value="30" min="5" max="300">
                        <small>–ö–∞–∫ —á–∞—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–∞—à–±–æ—Ä–¥–µ</small>
                    </div>

                    <button onclick="saveGeneralSettings()" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            `;
            
            document.getElementById('generalSettingsContent').innerHTML = html;
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
        async function saveGeneralSettings() {
            const settings = {
                server: {
                    port: document.getElementById('serverPort').value,
                    host: document.getElementById('serverHost').value
                },
                bot: {
                    debug_mode: document.getElementById('botDebugMode').checked,
                    auto_restart: document.getElementById('botAutoRestart').checked
                },
                dashboard: {
                    refresh_interval: document.getElementById('dashboardRefreshInterval').value
                }
            };
            
            showSuccess('–û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
            console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –æ–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:', settings);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        function loadSecuritySettings() {
            const html = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h5>üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</h5>
                    <div class="form-group">
                        <label for="sessionTimeout">–¢–∞–π–º–∞—É—Ç —Å–µ—Å—Å–∏–∏ (–º–∏–Ω—É—Ç—ã):</label>
                        <input type="number" id="sessionTimeout" value="60" min="5" max="1440">
                        <small>–í—Ä–µ–º—è –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã—Ö–æ–¥–∞</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="maxLoginAttempts">–ú–∞–∫—Å–∏–º—É–º –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞:</label>
                        <input type="number" id="maxLoginAttempts" value="5" min="3" max="20">
                        <small>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –¥–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏</small>
                    </div>

                    <h5>üõ°Ô∏è –ó–∞—â–∏—Ç–∞</h5>
                    <div class="form-group">
                        <label for="enableCORS">–í–∫–ª—é—á–∏—Ç—å CORS:</label>
                        <input type="checkbox" id="enableCORS" checked>
                        <small>–†–∞–∑—Ä–µ—à–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å –¥—Ä—É–≥–∏—Ö –¥–æ–º–µ–Ω–æ–≤</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="allowedOrigins">–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã:</label>
                        <textarea id="allowedOrigins" rows="3" placeholder="http://localhost:3000&#10;https://yourdomain.com">http://localhost:3000
https://yourdomain.com</textarea>
                        <small>–ü–æ –æ–¥–Ω–æ–º—É –¥–æ–º–µ–Ω—É –Ω–∞ —Å—Ç—Ä–æ–∫—É</small>
                    </div>

                    <h5>üîí –ü–∞—Ä–æ–ª–∏</h5>
                    <div class="form-group">
                        <label for="minPasswordLength">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è:</label>
                        <input type="number" id="minPasswordLength" value="8" min="6" max="50">
                    </div>
                    
                    <div class="form-group">
                        <label for="requireSpecialChars">–¢—Ä–µ–±–æ–≤–∞—Ç—å —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã:</label>
                        <input type="checkbox" id="requireSpecialChars">
                        <small>–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å !@#$%^&*</small>
                    </div>

                    <button onclick="saveSecuritySettings()" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            `;
            
            document.getElementById('securitySettingsContent').innerHTML = html;
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        async function saveSecuritySettings() {
            const settings = {
                auth: {
                    session_timeout: document.getElementById('sessionTimeout').value,
                    max_login_attempts: document.getElementById('maxLoginAttempts').value
                },
                security: {
                    enable_cors: document.getElementById('enableCORS').checked,
                    allowed_origins: document.getElementById('allowedOrigins').value.split('\n').filter(o => o.trim())
                },
                passwords: {
                    min_length: document.getElementById('minPasswordLength').value,
                    require_special_chars: document.getElementById('requireSpecialChars').checked
                }
            };
            
            showSuccess('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
            console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:', settings);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function loadNotificationSettings() {
            const html = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h5>üìß Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h5>
                    <div class="form-group">
                        <label for="smtpEnabled">–í–∫–ª—é—á–∏—Ç—å SMTP:</label>
                        <input type="checkbox" id="smtpEnabled">
                        <small>–û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ email</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="smtpHost">SMTP —Å–µ—Ä–≤–µ—Ä:</label>
                        <input type="text" id="smtpHost" placeholder="smtp.gmail.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="smtpPort">SMTP –ø–æ—Ä—Ç:</label>
                        <input type="number" id="smtpPort" value="587" min="1" max="65535">
                    </div>
                    
                    <div class="form-group">
                        <label for="smtpUser">SMTP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</label>
                        <input type="email" id="smtpUser" placeholder="your-email@gmail.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="smtpPassword">SMTP –ø–∞—Ä–æ–ª—å:</label>
                        <input type="password" id="smtpPassword" placeholder="app-password">
                    </div>

                    <h5>üîî Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h5>
                    <div class="form-group">
                        <label for="pushEnabled">–í–∫–ª—é—á–∏—Ç—å Push:</label>
                        <input type="checkbox" id="pushEnabled">
                        <small>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="pushVapidKey">VAPID –∫–ª—é—á:</label>
                        <input type="text" id="pushVapidKey" placeholder="BEl62iUYgUivxIkv69yViEuiBIa40HI...">
                    </div>

                    <h5>üì± Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h5>
                    <div class="form-group">
                        <label for="telegramEnabled">–í–∫–ª—é—á–∏—Ç—å Telegram:</label>
                        <input type="checkbox" id="telegramEnabled">
                    </div>
                    
                    <div class="form-group">
                        <label for="telegramBotToken">Bot Token:</label>
                        <input type="text" id="telegramBotToken" placeholder="123456789:ABCdefGHIjklMNOpqrsTUVwxyz">
                    </div>
                    
                    <div class="form-group">
                        <label for="telegramChatId">Chat ID:</label>
                        <input type="text" id="telegramChatId" placeholder="-1001234567890">
                    </div>

                    <button onclick="saveNotificationSettings()" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            `;
            
            document.getElementById('notificationSettingsContent').innerHTML = html;
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        async function saveNotificationSettings() {
            const settings = {
                email: {
                    enabled: document.getElementById('smtpEnabled').checked,
                    smtp_host: document.getElementById('smtpHost').value,
                    smtp_port: document.getElementById('smtpPort').value,
                    smtp_user: document.getElementById('smtpUser').value,
                    smtp_password: document.getElementById('smtpPassword').value
                },
                push: {
                    enabled: document.getElementById('pushEnabled').checked,
                    vapid_key: document.getElementById('pushVapidKey').value
                },
                telegram: {
                    enabled: document.getElementById('telegramEnabled').checked,
                    bot_token: document.getElementById('telegramBotToken').value,
                    chat_id: document.getElementById('telegramChatId').value
                }
            };
            
            showSuccess('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
            console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:', settings);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        function loadLoggingSettings() {
            const html = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h5>üìù –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</h5>
                    <div class="form-group">
                        <label for="logLevel">–£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:</label>
                        <select id="logLevel">
                            <option value="DEBUG">DEBUG - –ü–æ–¥—Ä–æ–±–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</option>
                            <option value="INFO" selected>INFO - –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</option>
                            <option value="WARNING">WARNING - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</option>
                            <option value="ERROR">ERROR - –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏</option>
                            <option value="CRITICAL">CRITICAL - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="logToFile">–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ —Ñ–∞–π–ª:</label>
                        <input type="checkbox" id="logToFile" checked>
                        <small>–°–æ—Ö—Ä–∞–Ω—è—Ç—å –ª–æ–≥–∏ –≤ —Ñ–∞–π–ª bot.log</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="logToConsole">–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–æ–Ω—Å–æ–ª—å:</label>
                        <input type="checkbox" id="logToConsole" checked>
                        <small>–í—ã–≤–æ–¥–∏—Ç—å –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞</small>
                    </div>

                    <h5>üìÅ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∞–º–∏</h5>
                    <div class="form-group">
                        <label for="maxLogSize">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ª–æ–≥–∞ (MB):</label>
                        <input type="number" id="maxLogSize" value="10" min="1" max="1000">
                        <small>–ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ñ–∞–π–ª</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="logRetentionDays">–•—Ä–∞–Ω–∏—Ç—å –ª–æ–≥–∏ (–¥–Ω–µ–π):</label>
                        <input type="number" id="logRetentionDays" value="30" min="1" max="365">
                        <small>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—Ç—å —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="logFormat">–§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤:</label>
                        <select id="logFormat">
                            <option value="simple">–ü—Ä–æ—Å—Ç–æ–π: 2024-01-01 12:00:00 - INFO - Message</option>
                            <option value="detailed" selected>–ü–æ–¥—Ä–æ–±–Ω—ã–π: 2024-01-01 12:00:00,123 - INFO - module:function:line - Message</option>
                            <option value="json">JSON: {"timestamp": "...", "level": "INFO", "message": "..."}</option>
                        </select>
                    </div>

                    <h5>üßπ –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤</h5>
                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button onclick="clearLogs()" class="btn btn-warning">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –ª–æ–≥–∏</button>
                        <button onclick="downloadLogs()" class="btn btn-info">üì• –°–∫–∞—á–∞—Ç—å –ª–æ–≥–∏</button>
                        <button onclick="archiveLogs()" class="btn btn-secondary">üì¶ –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏</button>
                    </div>

                    <button onclick="saveLoggingSettings()" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            `;
            
            document.getElementById('loggingSettingsContent').innerHTML = html;
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        async function saveLoggingSettings() {
            const settings = {
                level: document.getElementById('logLevel').value,
                to_file: document.getElementById('logToFile').checked,
                to_console: document.getElementById('logToConsole').checked,
                max_size_mb: document.getElementById('maxLogSize').value,
                retention_days: document.getElementById('logRetentionDays').value,
                format: document.getElementById('logFormat').value
            };
            
            showSuccess('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
            console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:', settings);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
        function loadMaintenanceSettings() {
            const html = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h5>ü§ñ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º</h5>
                    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                        <button onclick="startBot()" class="btn btn-success">‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞</button>
                        <button onclick="stopBot()" class="btn btn-danger">‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞</button>
                        <button onclick="restartBot()" class="btn btn-warning">üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞</button>
                    </div>

                    <h5>üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã</h5>
                    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                        <button onclick="restartAdminServer()" class="btn btn-warning">üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</button>
                        <button onclick="restartAll()" class="btn btn-danger">‚ö° –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—ë</button>
                    </div>

                    <h5>üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</h5>
                    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                        <button onclick="createBackup()" class="btn btn-success">üíæ –°–æ–∑–¥–∞—Ç—å backup</button>
                        <button onclick="restoreBackup()" class="btn btn-info">üì• –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å backup</button>
                        <button onclick="listBackups()" class="btn btn-secondary">üìã –°–ø–∏—Å–æ–∫ backup'–æ–≤</button>
                    </div>

                    <h5>üßπ –û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã</h5>
                    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                        <button onclick="clearCache()" class="btn btn-warning">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à</button>
                        <button onclick="clearTempFiles()" class="btn btn-warning">üìÅ –û—á–∏—Å—Ç–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã</button>
                        <button onclick="optimizeDatabase()" class="btn btn-info">‚ö° –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ë–î</button>
                    </div>

                    <h5>üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã</h5>
                    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                        <button onclick="checkSystemHealth()" class="btn btn-info">üíö –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ —Å–∏—Å—Ç–µ–º—ã</button>
                        <button onclick="viewSystemInfo()" class="btn btn-secondary">‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ</button>
                        <button onclick="testConnections()" class="btn btn-primary">üîó –¢–µ—Å—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π</button>
                    </div>

                    <h5>‚öôÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</h5>
                    <div class="form-group">
                        <label for="autoBackup">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ backup'—ã:</label>
                        <input type="checkbox" id="autoBackup" checked>
                        <small>–°–æ–∑–¥–∞–≤–∞—Ç—å backup –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 02:00</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="autoCleanup">–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤:</label>
                        <input type="checkbox" id="autoCleanup" checked>
                        <small>–£–¥–∞–ª—è—Ç—å –ª–æ–≥–∏ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="autoRestart">–ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫:</label>
                        <input type="checkbox" id="autoRestart">
                        <small>–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö</small>
                    </div>

                    <button onclick="saveMaintenanceSettings()" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            `;
            
            document.getElementById('maintenanceSettingsContent').innerHTML = html;
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
        async function saveMaintenanceSettings() {
            const settings = {
                auto_backup: document.getElementById('autoBackup').checked,
                auto_cleanup: document.getElementById('autoCleanup').checked,
                auto_restart: document.getElementById('autoRestart').checked
            };
            
            showSuccess('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
            console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è:', settings);
        }

        // –§—É–Ω–∫—Ü–∏–∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
        async function restartAdminServer() {
            if (confirm('–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å? –≠—Ç–æ –∑–∞–∫—Ä–æ–µ—Ç —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é.')) {
                showSuccess('–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∞...');
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã API –≤—ã–∑–æ–≤ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
            }
        }

        // –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
        async function startBot() {
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/bot/start`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                if (data.success) {
                    showSuccess('–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                } else {
                    showError('settingsError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞:', error);
                showError('settingsError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞
        async function stopBot() {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞?')) {
                return;
            }
            
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/bot/stop`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                if (data.success) {
                    showSuccess('–ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
                } else {
                    showError('settingsError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–æ—Ç–∞:', error);
                showError('settingsError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
        async function restartBot() {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞?')) {
                return;
            }
            
            try {
                // –°–Ω–∞—á–∞–ª–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
                await fetch(`${SMARTAPP_URL}/api/bot/stop`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                // –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // –ó–∞—Ç–µ–º –∑–∞–ø—É—Å–∫–∞–µ–º
                const response = await fetch(`${SMARTAPP_URL}/api/bot/start`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                if (data.success) {
                    showSuccess('–ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω');
                } else {
                    showError('settingsError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞:', error);
                showError('settingsError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        async function restartAll() {
            if (confirm('–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—é —Å–∏—Å—Ç–µ–º—É? –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–µ—Ä–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞.')) {
                try {
                    // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
                    await restartBot();
                    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã API –≤—ã–∑–æ–≤ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
                    showSuccess('–°–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∞...');
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–∏—Å—Ç–µ–º—ã:', error);
                    showError('settingsError', '–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–∏—Å—Ç–µ–º—ã');
                }
            }
        }

        async function createBackup() {
            showSuccess('–°–æ–∑–¥–∞–Ω–∏–µ backup...');
        }

        async function clearCache() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à —Å–∏—Å—Ç–µ–º—ã?')) {
                showSuccess('–ö—ç—à –æ—á–∏—â–µ–Ω');
            }
        }

        async function checkSystemHealth() {
            showSuccess('–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã...');
        }

        async function testConnections() {
            showSuccess('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π...');
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª–æ–≥–∞–º–∏
        async function clearLogs() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ª–æ–≥–∏? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.')) {
                showSuccess('–õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã');
            }
        }

        async function downloadLogs() {
            showSuccess('–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤...');
        }

        async function archiveLogs() {
            showSuccess('–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤...');
        }

        // ==================== –§–£–ù–ö–¶–ò–ò –°–¢–†–ï–°–°-–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø ====================

        let stressTestRunning = false;
        let stressTestResults = [];

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function loadStressTestSettings() {
            console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...');
            const targetElement = document.getElementById('stressTestSettingsContent');
            console.log('–¶–µ–ª–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç:', targetElement);
            
            const content = `
                <div class="form-group">
                    <label>üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</label>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 10px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div>
                                <label for="stressTestType">–¢–∏–ø —Ç–µ—Å—Ç–∞:</label>
                                <select id="stressTestType" onchange="updateStressTestConfig()">
                                    <option value="applications">–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫</option>
                                    <option value="users">–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</option>
                                    <option value="notifications">–û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</option>
                                    <option value="mixed">–°–º–µ—à–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç</option>
                                </select>
                            </div>
                            <div>
                                <label for="stressTestCount">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π:</label>
                                <input type="number" id="stressTestCount" value="100" min="1" max="10000">
                            </div>
                            <div>
                                <label for="stressTestDelay">–ó–∞–¥–µ—Ä–∂–∫–∞ (–º—Å):</label>
                                <input type="number" id="stressTestDelay" value="100" min="0" max="5000">
                            </div>
                            <div>
                                <label for="stressTestConcurrency">–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å:</label>
                                <input type="number" id="stressTestConcurrency" value="5" min="1" max="50">
                            </div>
                        </div>
                        <div style="margin-top: 15px;">
                            <button class="btn btn-primary" onclick="startStressTest()" id="startStressTestBtn">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
                            <button class="btn btn-danger" onclick="stopStressTest()" id="stopStressTestBtn" disabled>‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                            <button class="btn btn-info" onclick="clearStressTestResults()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</label>
                    <div id="stressTestResults" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 10px; min-height: 200px;">
                        <p style="color: #666; text-align: center;">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</p>
                    </div>
                </div>
            `;
            
            console.log('–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...');
            if (targetElement) {
                targetElement.innerHTML = content;
                console.log('–ö–æ–Ω—Ç–µ–Ω—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ');
            } else {
                console.error('–≠–ª–µ–º–µ–Ω—Ç stressTestSettingsContent –Ω–µ –Ω–∞–π–¥–µ–Ω!');
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∞
        function updateStressTestConfig() {
            const testType = document.getElementById('stressTestType').value;
            const countInput = document.getElementById('stressTestCount');
            const delayInput = document.getElementById('stressTestDelay');
            const concurrencyInput = document.getElementById('stressTestConcurrency');
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Ç–µ—Å—Ç–∞
            switch (testType) {
                case 'applications':
                    countInput.value = 100;
                    delayInput.value = 100;
                    concurrencyInput.value = 5;
                    break;
                case 'users':
                    countInput.value = 50;
                    delayInput.value = 200;
                    concurrencyInput.value = 3;
                    break;
                case 'notifications':
                    countInput.value = 200;
                    delayInput.value = 50;
                    concurrencyInput.value = 10;
                    break;
                case 'mixed':
                    countInput.value = 50;
                    delayInput.value = 150;
                    concurrencyInput.value = 3;
                    break;
            }
        }

        // –ó–∞–ø—É—Å–∫ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∞
        async function startStressTest() {
            if (stressTestRunning) {
                showError('stressTestError', '–¢–µ—Å—Ç —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è');
                return;
            }

            const testType = document.getElementById('stressTestType').value;
            const count = parseInt(document.getElementById('stressTestCount').value);
            const delay = parseInt(document.getElementById('stressTestDelay').value);
            const concurrency = parseInt(document.getElementById('stressTestConcurrency').value);

            if (count < 1 || count > 10000) {
                showError('stressTestError', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 1 –¥–æ 10000');
                return;
            }

            stressTestRunning = true;
            document.getElementById('startStressTestBtn').disabled = true;
            document.getElementById('stopStressTestBtn').disabled = false;

            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            document.getElementById('stressTestResults').innerHTML = '<div class="loading">–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞...</div>';

            try {
                const response = await fetch(`${SMARTAPP_URL}/api/stress-test/start`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({
                        test_type: testType,
                        count: count,
                        delay: delay,
                        concurrency: concurrency
                    })
                });

                const data = await response.json();
                if (data.success) {
                    showSuccess('–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç –∑–∞–ø—É—â–µ–Ω');
                    // –ù–∞—á–∏–Ω–∞–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                    monitorStressTest();
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∞:', error);
                showError('stressTestError', '–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–∞: ' + error.message);
                stressTestRunning = false;
                document.getElementById('startStressTestBtn').disabled = false;
                document.getElementById('stopStressTestBtn').disabled = true;
            }
        }

        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∞
        async function stopStressTest() {
            if (!stressTestRunning) return;

            try {
                const response = await fetch(`${SMARTAPP_URL}/api/stress-test/stop`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                const data = await response.json();
                if (data.success) {
                    showSuccess('–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∞:', error);
            }

            stressTestRunning = false;
            document.getElementById('startStressTestBtn').disabled = false;
            document.getElementById('stopStressTestBtn').disabled = true;
        }

        // –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∞
        async function monitorStressTest() {
            if (!stressTestRunning) return;

            try {
                const response = await fetch(`${SMARTAPP_URL}/api/stress-test/status`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    displayStressTestResults(data);
                    
                    if (data.status === 'running') {
                        // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
                        setTimeout(monitorStressTest, 1000);
                    } else {
                        // –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω
                        stressTestRunning = false;
                        document.getElementById('startStressTestBtn').disabled = false;
                        document.getElementById('stopStressTestBtn').disabled = true;
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:', error);
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∞
        function displayStressTestResults(data) {
            const resultsDiv = document.getElementById('stressTestResults');
            
            let html = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4 style="margin: 0; color: #1976d2;">${data.completed || 0}</h4>
                        <p style="margin: 5px 0 0 0; color: #666;">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</p>
                    </div>
                    <div style="background: #fff3e0; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4 style="margin: 0; color: #f57c00;">${data.total || 0}</h4>
                        <p style="margin: 5px 0 0 0; color: #666;">–í—Å–µ–≥–æ</p>
                    </div>
                    <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4 style="margin: 0; color: #388e3c;">${data.success_rate || 0}%</h4>
                        <p style="margin: 5px 0 0 0; color: #666;">–£—Å–ø–µ—à–Ω–æ—Å—Ç—å</p>
                    </div>
                    <div style="background: #f3e5f5; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4 style="margin: 0; color: #7b1fa2;">${data.avg_response_time || 0}–º—Å</h4>
                        <p style="margin: 5px 0 0 0; color: #666;">–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è</p>
                    </div>
                </div>
            `;

            if (data.status === 'running') {
                html += `
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h5 style="margin: 0; color: #856404;">üîÑ –¢–µ—Å—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...</h5>
                        <div style="background: #e9ecef; border-radius: 4px; height: 20px; margin-top: 10px;">
                            <div style="background: #28a745; height: 100%; border-radius: 4px; width: ${(data.completed / data.total) * 100}%; transition: width 0.3s;"></div>
                        </div>
                        <p style="margin: 5px 0 0 0; color: #666;">${data.completed} –∏–∑ ${data.total} –æ–ø–µ—Ä–∞—Ü–∏–π</p>
                    </div>
                `;
            } else if (data.status === 'completed') {
                html += `
                    <div style="background: #d4edda; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h5 style="margin: 0; color: #155724;">‚úÖ –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω</h5>
                        <p style="margin: 5px 0 0 0; color: #666;">–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ${data.duration || 0}—Å</p>
                    </div>
                `;
            } else if (data.status === 'error') {
                html += `
                    <div style="background: #f8d7da; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h5 style="margin: 0; color: #721c24;">‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞</h5>
                        <p style="margin: 5px 0 0 0; color: #666;">${data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}</p>
                    </div>
                `;
            }

            // –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            if (data.details) {
                html += `
                    <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #dee2e6;">
                        <h6>üìä –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h6>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                            <div><strong>–£—Å–ø–µ—à–Ω—ã—Ö:</strong> ${data.details.successful || 0}</div>
                            <div><strong>–û—à–∏–±–æ–∫:</strong> ${data.details.errors || 0}</div>
                            <div><strong>–ú–∏–Ω. –≤—Ä–µ–º—è:</strong> ${data.details.min_time || 0}–º—Å</div>
                            <div><strong>–ú–∞–∫—Å. –≤—Ä–µ–º—è:</strong> ${data.details.max_time || 0}–º—Å</div>
                            <div><strong>RPS:</strong> ${data.details.rps || 0}</div>
                            <div><strong>–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å:</strong> ${data.details.concurrency || 0}</div>
                        </div>
                    </div>
                `;
            }

            resultsDiv.innerHTML = html;
        }

        // –û—á–∏—Å—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∞
        function clearStressTestResults() {
            document.getElementById('stressTestResults').innerHTML = '<p style="color: #666; text-align: center;">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</p>';
        }

        // ==================== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –ó–ê–Ø–í–ö–ê–ú–ò ====================

        let applicationsData = [];
        let filteredApplications = [];
        let currentPage = 1;
        let itemsPerPage = 20;
        let autoRefreshInterval = null;
        let isAutoRefreshEnabled = false;

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫
        async function loadApplications() {
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/applications`, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    applicationsData = data.applications || [];
                    filteredApplications = [...applicationsData];
                    displayApplications();
                    loadApplicationsStats();
                } else {
                    document.getElementById('applicationsTable').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫</div>';
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫:', error);
                document.getElementById('applicationsTable').innerHTML = '<div class="error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º</div>';
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞—è–≤–æ–∫
        async function loadApplicationsStats() {
            const stats = {
                total: applicationsData.length,
                today: applicationsData.filter(app => {
                    const today = new Date().toDateString();
                    return new Date(app.created_at).toDateString() === today;
                }).length,
                thisWeek: applicationsData.filter(app => {
                    const weekAgo = new Date();
                    weekAgo.setDate(weekAgo.getDate() - 7);
                    return new Date(app.created_at) >= weekAgo;
                }).length,
                thisMonth: applicationsData.filter(app => {
                    const monthAgo = new Date();
                    monthAgo.setMonth(monthAgo.getMonth() - 1);
                    return new Date(app.created_at) >= monthAgo;
                }).length
            };

            const statsHtml = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4 style="margin: 0; color: #1976d2;">${stats.total}</h4>
                        <p style="margin: 5px 0 0 0; color: #666;">–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫</p>
                    </div>
                    <div style="background: #e0f2f1; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4 style="margin: 0; color: #00695c;">${stats.today}</h4>
                        <p style="margin: 5px 0 0 0; color: #666;">–°–µ–≥–æ–¥–Ω—è</p>
                    </div>
                    <div style="background: #fff3e0; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4 style="margin: 0; color: #f57c00;">${stats.thisWeek}</h4>
                        <p style="margin: 5px 0 0 0; color: #666;">–ó–∞ –Ω–µ–¥–µ–ª—é</p>
                    </div>
                    <div style="background: #f3e5f5; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4 style="margin: 0; color: #7b1fa2;">${stats.thisMonth}</h4>
                        <p style="margin: 5px 0 0 0; color: #666;">–ó–∞ –º–µ—Å—è—Ü</p>
                    </div>
                </div>
            `;
            
            document.getElementById('applicationsStats').innerHTML = statsHtml;
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞—è–≤–æ–∫
        function displayApplications() {
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageApplications = filteredApplications.slice(startIndex, endIndex);

            if (pageApplications.length === 0) {
                document.getElementById('applicationsTable').innerHTML = '<div style="text-align: center; padding: 40px; color: #666;">–ó–∞—è–≤–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                document.getElementById('applicationsPagination').style.display = 'none';
                return;
            }

            let html = `
                <table class="users-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–§–ò–û</th>
                            <th>–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</th>
                            <th>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                            <th>–î–∞—Ç–∞ –≤—ã–ª–µ—Ç–∞</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            pageApplications.forEach(app => {
                html += `
                    <tr>
                        <td>#${app.id || 'N/A'}</td>
                        <td>${app.full_name || 'N/A'}</td>
                        <td>${app.direction || 'N/A'}</td>
                        <td>${new Date(app.created_at).toLocaleDateString('ru-RU')}</td>
                        <td>${app.departure_date || 'N/A'}</td>
                        <td>
                            <button class="btn btn-info" onclick="viewApplication(${app.id})">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä</button>
                            <button class="btn btn-warning" onclick="editApplication(${app.id})">‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å</button>
                        </td>
                    </tr>
                `;
            });

            html += '</tbody></table>';
            document.getElementById('applicationsTable').innerHTML = html;

            // –ü–∞–≥–∏–Ω–∞—Ü–∏—è
            const totalPages = Math.ceil(filteredApplications.length / itemsPerPage);
            if (totalPages > 1) {
                document.getElementById('applicationsPagination').style.display = 'block';
                document.getElementById('pageInfo').textContent = `–°—Ç—Ä–∞–Ω–∏—Ü–∞ ${currentPage} –∏–∑ ${totalPages}`;
            } else {
                document.getElementById('applicationsPagination').style.display = 'none';
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ —Å—Ç–∞—Ç—É—Å–∞
        function getStatusClass(status) {
            const statusClasses = {
                'pending': 'status-pending',
                'approved': 'status-approved',
                'rejected': 'status-rejected',
                'completed': 'status-completed'
            };
            return statusClasses[status] || 'status-pending';
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å—Ç–∞—Ç—É—Å–∞
        function getStatusText(status) {
            const statusTexts = {
                'pending': '–û–∂–∏–¥–∞–µ—Ç',
                'approved': '–û–¥–æ–±—Ä–µ–Ω–∞',
                'rejected': '–û—Ç–∫–ª–æ–Ω–µ–Ω–∞',
                'completed': '–ó–∞–≤–µ—Ä—à–µ–Ω–∞'
            };
            return statusTexts[status] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞—è–≤–æ–∫
        function filterApplications() {
            const statusFilter = document.getElementById('statusFilter').value;
            const dateFilter = document.getElementById('dateFilter').value;
            const searchFilter = document.getElementById('searchFilter').value.toLowerCase();

            filteredApplications = applicationsData.filter(app => {
                // –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É
                if (statusFilter && app.status !== statusFilter) {
                    return false;
                }

                // –§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ
                if (dateFilter !== 'all') {
                    const appDate = new Date(app.created_at);
                    const now = new Date();
                    
                    switch (dateFilter) {
                        case 'today':
                            if (appDate.toDateString() !== now.toDateString()) return false;
                            break;
                        case 'week':
                            const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                            if (appDate < weekAgo) return false;
                            break;
                        case 'month':
                            const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                            if (appDate < monthAgo) return false;
                            break;
                    }
                }

                // –ü–æ–∏—Å–∫
                if (searchFilter) {
                    const searchText = `${app.full_name || ''} ${app.direction || ''} ${app.id || ''}`.toLowerCase();
                    if (!searchText.includes(searchFilter)) return false;
                }

                return true;
            });

            currentPage = 1;
            displayApplications();
            loadApplicationsStats();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–æ–∫
        function refreshApplications() {
            loadApplications();
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        function toggleAutoRefresh() {
            const btn = document.getElementById('autoRefreshBtn');
            
            if (isAutoRefreshEnabled) {
                clearInterval(autoRefreshInterval);
                isAutoRefreshEnabled = false;
                btn.textContent = '‚ñ∂Ô∏è –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ';
                btn.classList.remove('btn-danger');
                btn.classList.add('btn-primary');
            } else {
                autoRefreshInterval = setInterval(loadApplications, 30000); // –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
                isAutoRefreshEnabled = true;
                btn.textContent = '‚è∏Ô∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å';
                btn.classList.remove('btn-primary');
                btn.classList.add('btn-danger');
            }
        }

        // –ü–∞–≥–∏–Ω–∞—Ü–∏—è
        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                displayApplications();
            }
        }

        function nextPage() {
            const totalPages = Math.ceil(filteredApplications.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                displayApplications();
            }
        }

        // –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞—è–≤–∫–∏
        function viewApplication(id) {
            const app = applicationsData.find(a => a.id === id);
            if (app) {
                alert(`–ó–∞—è–≤–∫–∞ #${id}\n–§–ò–û: ${app.full_name}\n–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: ${app.direction}\n–°—Ç–∞—Ç—É—Å: ${getStatusText(app.status)}\n–î–∞—Ç–∞: ${new Date(app.created_at).toLocaleString()}`);
            }
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏
        function editApplication(id) {
            const app = applicationsData.find(a => a.id === id);
            if (app) {
                const newStatus = prompt('–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:', app.status);
                if (newStatus && newStatus !== app.status) {
                    updateApplicationStatus(id, newStatus);
                }
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏
        async function updateApplicationStatus(id, status) {
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/applications/${id}/status`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ status })
                });

                const data = await response.json();
                if (data.success) {
                    showSuccess('–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω');
                    loadApplications();
                } else {
                    showError('applicationsError', data.error);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:', error);
                showError('applicationsError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
        async function exportToExcel() {
            try {
                const response = await fetch(`${SMARTAPP_URL}/api/applications/export`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({
                        filters: {
                            status: document.getElementById('statusFilter').value,
                            date: document.getElementById('dateFilter').value,
                            search: document.getElementById('searchFilter').value
                        }
                    })
                });

                if (response.ok) {
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `applications_${new Date().toISOString().split('T')[0]}.xlsx`;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                    showSuccess('–§–∞–π–ª Excel –∑–∞–≥—Ä—É–∂–µ–Ω');
                } else {
                    showError('applicationsError', '–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞:', error);
                showError('applicationsError', '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }
    </script>
</body>
</html>
